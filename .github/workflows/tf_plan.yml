name: Terraform plan
on:
  workflow_dispatch:
  pull_request:
    paths:
      - "terraform/**"
      - ".github/workflows/**"

permissions:
  id-token: write
  contents: read
  pull-requests: write
  actions: write
  checks: write
  statuses: write

jobs:
  terraform-plan:
    strategy:
      fail-fast: false
      matrix:
        include:
          - module: terraform
    uses: cds-snc/workflows/.github/workflows/terragrunt-plan.yml@main
    with:
      module: ${{ matrix.module }}
      role_name: sre-bot-plan
      terraform_version: 1.3.3
      terragrunt_version: 0.31.1
